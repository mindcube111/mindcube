# ğŸš€ éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—å°†å¸®åŠ©æ‚¨å°† MIND CUBE å¿ƒç†æµ‹è¯„ç®¡ç†å¹³å°éƒ¨ç½²åˆ° Cloudflare Pagesã€‚

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. å‰ç½®è¦æ±‚

- âœ… Node.js 16+ å·²å®‰è£…
- âœ… npm æˆ– yarn å·²å®‰è£…
- âœ… Cloudflare è´¦å·å·²æ³¨å†Œ
- âœ… é¡¹ç›®ä»£ç å·²å‡†å¤‡å¥½

### 2. å®‰è£…ä¾èµ–

```bash
cd "02 ç®¡ç†å™¨"
npm install
```

## ğŸ”¨ æ„å»ºé¡¹ç›®

### æœ¬åœ°æ„å»º

```bash
npm run build
```

æ„å»ºæ­¥éª¤åŒ…æ‹¬ï¼š
1. TypeScript ç±»å‹æ£€æŸ¥ (`tsc`)
2. Vite æ„å»º (`vite build`)
3. å¤åˆ¶ Functions æ–‡ä»¶åˆ° dist (`copy-functions`)

æ„å»ºå®Œæˆåï¼Œ`dist` ç›®å½•å°†åŒ…å«ï¼š
- `index.html` - å…¥å£æ–‡ä»¶
- `assets/` - æ‰“åŒ…åçš„ JS/CSS æ–‡ä»¶
- `functions/` - Cloudflare Workers Functions
  - `_middleware.js` - ä¸­é—´ä»¶
  - `api/[[path]].js` - API è·¯ç”±
  - `utils/` - å·¥å…·å‡½æ•°

## ğŸŒ éƒ¨ç½²åˆ° Cloudflare Pages

### æ–¹å¼ä¸€ï¼šé€šè¿‡ Cloudflare Dashboardï¼ˆæ¨èï¼‰

1. **ç™»å½• Cloudflare Dashboard**
   - è®¿é—® [Cloudflare Dashboard](https://dash.cloudflare.com/)
   - é€‰æ‹©æ‚¨çš„è´¦æˆ·

2. **åˆ›å»º Pages é¡¹ç›®**
   - ç‚¹å‡»å·¦ä¾§èœå• "Pages"
   - ç‚¹å‡» "Create a project"
   - é€‰æ‹© "Connect to Git"ï¼ˆå¦‚æœä½¿ç”¨ Gitï¼‰æˆ– "Upload assets"

3. **è¿æ¥ Git ä»“åº“ï¼ˆæ¨èï¼‰**
   - é€‰æ‹©æ‚¨çš„ Git æä¾›å•†ï¼ˆGitHub/GitLab/Bitbucketï¼‰
   - æˆæƒ Cloudflare è®¿é—®æ‚¨çš„ä»“åº“
   - é€‰æ‹©ä»“åº“å’Œåˆ†æ”¯
   - é…ç½®æ„å»ºè®¾ç½®ï¼š
     - **Build command**: `npm run build`
     - **Build output directory**: `dist`
     - **Root directory**: `02 ç®¡ç†å™¨`ï¼ˆå¦‚æœé¡¹ç›®åœ¨å­ç›®å½•ï¼‰

4. **é…ç½®ç¯å¢ƒå˜é‡**
   - åœ¨é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ å¿…è¦çš„ç¯å¢ƒå˜é‡
   - ä¾‹å¦‚ï¼š`NODE_VERSION=18`ï¼ˆå¦‚æœéœ€è¦ï¼‰

5. **é…ç½® Functions**
   - Cloudflare ä¼šè‡ªåŠ¨æ£€æµ‹ `dist/functions` ç›®å½•
   - ç¡®ä¿æ„å»ºè„šæœ¬å·²å¤åˆ¶ Functions æ–‡ä»¶

6. **éƒ¨ç½²**
   - ç‚¹å‡» "Save and Deploy"
   - ç­‰å¾…æ„å»ºå®Œæˆï¼ˆé€šå¸¸ 2-5 åˆ†é’Ÿï¼‰

### æ–¹å¼äºŒï¼šä½¿ç”¨ Wrangler CLI

1. **å®‰è£… Wrangler**

```bash
npm install -g wrangler
```

2. **ç™»å½• Cloudflare**

```bash
wrangler login
```

3. **éƒ¨ç½²é¡¹ç›®**

```bash
# æ„å»ºé¡¹ç›®
npm run build

# éƒ¨ç½²åˆ° Cloudflare Pages
wrangler pages deploy dist --project-name=psychological-assessment-platform
```

### æ–¹å¼ä¸‰ï¼šä½¿ç”¨éƒ¨ç½²è„šæœ¬

è¿è¡Œæä¾›çš„éƒ¨ç½²è„šæœ¬ï¼š

```bash
# Windows PowerShell
.\scripts\deploy.ps1

# æˆ–ä½¿ç”¨ Node.js è„šæœ¬
node scripts/deploy.js
```

## âš™ï¸ é…ç½® KV Namespaceï¼ˆå¦‚éœ€è¦ï¼‰

å¦‚æœé¡¹ç›®ä½¿ç”¨äº† KV å­˜å‚¨ï¼š

1. **åˆ›å»º KV Namespace**
   ```bash
   wrangler kv:namespace create "KV_STORE"
   ```

2. **åœ¨ Cloudflare Dashboard ä¸­ç»‘å®š**
   - è¿›å…¥ Pages é¡¹ç›®è®¾ç½®
   - é€‰æ‹© "Functions"
   - æ·»åŠ  KV namespace binding
   - å˜é‡åï¼š`KV_STORE`
   - Namespaceï¼šé€‰æ‹©æ‚¨åˆ›å»ºçš„ namespace

3. **æ›´æ–°ç”Ÿäº§ç¯å¢ƒç»‘å®š**
   ```bash
   wrangler kv:namespace create "KV_STORE" --preview
   ```

## ğŸ” éªŒè¯éƒ¨ç½²

éƒ¨ç½²å®Œæˆåï¼Œè®¿é—®ï¼š

- **ç½‘ç«™åœ°å€**: `https://[æ‚¨çš„é¡¹ç›®å].pages.dev`
- **API æµ‹è¯•**: `https://[æ‚¨çš„é¡¹ç›®å].pages.dev/api/questionnaires/available`

## ğŸ› ï¸ å¸¸è§é—®é¢˜

### é—®é¢˜ 1: Functions æœªéƒ¨ç½²

**ç—‡çŠ¶**: API è·¯ç”±è¿”å› 404

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤æ„å»ºè„šæœ¬åŒ…å« `npm run copy-functions`
2. æ£€æŸ¥ `dist/functions` ç›®å½•æ˜¯å¦å­˜åœ¨
3. åœ¨ Cloudflare Dashboard ä¸­æŸ¥çœ‹ Functions æ ‡ç­¾é¡µ

### é—®é¢˜ 2: æ„å»ºå¤±è´¥

**ç—‡çŠ¶**: éƒ¨ç½²æ—¶æ„å»ºé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æœ¬åœ°è¿è¡Œ `npm run build` æ£€æŸ¥é”™è¯¯
2. ç¡®è®¤æ‰€æœ‰ä¾èµ–å·²å®‰è£…
3. æ£€æŸ¥ Node.js ç‰ˆæœ¬ï¼ˆæ¨è 18+ï¼‰

### é—®é¢˜ 3: ç½‘ç«™æ— æ³•è®¿é—®

**ç—‡çŠ¶**: éƒ¨ç½²æˆåŠŸä½†ç½‘ç«™æ˜¾ç¤ºé”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. ç­‰å¾… 2-5 åˆ†é’Ÿè®©åŸŸåç”Ÿæ•ˆ
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
3. æ£€æŸ¥ Cloudflare Dashboard ä¸­çš„éƒ¨ç½²çŠ¶æ€
4. æŸ¥çœ‹æ„å»ºæ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯

### é—®é¢˜ 4: API è·¯ç”± 404

**ç—‡çŠ¶**: å‰ç«¯æ­£å¸¸ä½† API ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤ `dist/functions/api/[[path]].js` å­˜åœ¨
2. æ£€æŸ¥ API è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆåº”è¯¥æ˜¯ `/api/...`ï¼‰
3. æŸ¥çœ‹ Cloudflare Workers æ—¥å¿—

## ğŸ“ æ›´æ–°éƒ¨ç½²

æ¯æ¬¡ä»£ç æ›´æ–°åï¼Œé‡æ–°éƒ¨ç½²ï¼š

```bash
# æ–¹å¼ä¸€ï¼šé€šè¿‡ Gitï¼ˆæ¨èï¼‰
git add .
git commit -m "æ›´æ–°å†…å®¹"
git push

# Cloudflare ä¼šè‡ªåŠ¨æ£€æµ‹å¹¶éƒ¨ç½²

# æ–¹å¼äºŒï¼šæ‰‹åŠ¨éƒ¨ç½²
npm run build
wrangler pages deploy dist --project-name=psychological-assessment-platform
```

## ğŸ” ç”Ÿäº§ç¯å¢ƒæ³¨æ„äº‹é¡¹

1. **ç¯å¢ƒå˜é‡**: ç¡®ä¿æ‰€æœ‰æ•æ„Ÿä¿¡æ¯éƒ½ä½¿ç”¨ç¯å¢ƒå˜é‡
2. **HTTPS**: Cloudflare Pages è‡ªåŠ¨æä¾› HTTPS
3. **CDN**: é™æ€èµ„æºä¼šè‡ªåŠ¨é€šè¿‡ Cloudflare CDN åŠ é€Ÿ
4. **ç›‘æ§**: åœ¨ Cloudflare Dashboard ä¸­ç›‘æ§è®¿é—®é‡ã€é”™è¯¯ç­‰

## ğŸ“š ç›¸å…³èµ„æº

- [Cloudflare Pages æ–‡æ¡£](https://developers.cloudflare.com/pages/)
- [Cloudflare Workers æ–‡æ¡£](https://developers.cloudflare.com/workers/)
- [é¡¹ç›® README](README.md)

## âœ… éƒ¨ç½²æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰è¯·ç¡®è®¤ï¼š

- [ ] ä¾èµ–å·²å®‰è£… (`npm install`)
- [ ] é¡¹ç›®å¯ä»¥æœ¬åœ°æ„å»º (`npm run build`)
- [ ] `dist/functions` ç›®å½•å­˜åœ¨ä¸”æœ‰å†…å®¹
- [ ] æ‰€æœ‰ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] KV Namespace å·²ç»‘å®šï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] Git ä»“åº“å·²è¿æ¥ï¼ˆå¦‚ä½¿ç”¨ Git éƒ¨ç½²ï¼‰

---

**éƒ¨ç½²æˆåŠŸåï¼Œè®°å¾—æµ‹è¯•æ‰€æœ‰åŠŸèƒ½ï¼** ğŸ‰

